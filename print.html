<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Knowledge Base</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html"><strong aria-hidden="true">1.</strong> Knowledge Base</a></li><li class="chapter-item expanded "><a href="software-testing/index.html"><strong aria-hidden="true">2.</strong> Software Testing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="software-testing/srs.html"><strong aria-hidden="true">2.1.</strong> Software Requirements Specification</a></li><li class="chapter-item expanded "><a href="software-testing/white-box.html"><strong aria-hidden="true">2.2.</strong> White Box Testing</a></li><li class="chapter-item expanded "><a href="software-testing/black-box.html"><strong aria-hidden="true">2.3.</strong> Black Box Testing</a></li></ol></li><li class="chapter-item expanded "><a href="advanced-os/index.html"><strong aria-hidden="true">3.</strong> Advanced Operating Systems</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="advanced-os/booting.html"><strong aria-hidden="true">3.1.</strong> Booting</a></li><li class="chapter-item expanded "><a href="advanced-os/memory.html"><strong aria-hidden="true">3.2.</strong> Memory</a></li><li class="chapter-item expanded "><a href="advanced-os/page-tables.html"><strong aria-hidden="true">3.3.</strong> Page Tables</a></li><li class="chapter-item expanded "><a href="advanced-os/user-mode.html"><strong aria-hidden="true">3.4.</strong> User Mode</a></li><li class="chapter-item expanded "><a href="advanced-os/interrupts.html"><strong aria-hidden="true">3.5.</strong> Interrupts</a></li><li class="chapter-item expanded "><a href="advanced-os/system-calls.html"><strong aria-hidden="true">3.6.</strong> System Calls</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Knowledge Base</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="knowledge-base"><a class="header" href="#knowledge-base">Knowledge Base</a></h1>
<p>A hierarchically organized knowledge-base of things I am learning. Forever a <em>work in progress</em>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="software-testing"><a class="header" href="#software-testing">Software Testing</a></h1>
<p>Software Testing is closely coupled with Requirements Engineering and Software Verification, however this section mostly covers important testing techniques and construction of test plans as well as software requirements.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="srs"><a class="header" href="#srs">SRS</a></h1>
<p>An SRS document supplies the reader with all the necessary information to understand the Functional and Non-Functional Requirements. The following is a template:</p>
<h4 id="introduction"><a class="header" href="#introduction">Introduction</a></h4>
<ul>
<li>
<p><strong>Purpose</strong> -
Identify the product whose software requirements are specified in this document, including the
revision or release number. Describe the scope of the product that is covered by this SRS,
particularly if this SRS describes only part of the system or a single subsystem.</p>
</li>
<li>
<p><strong>Document Conventions</strong> -
Describe any standards or typographical conventions that were followed when writing this SRS,
such as fonts or highlighting that have special significance. For example, state whether priorities
for higher-level requirements are assumed to be inherited by detailed requirements, or whether
every requirement statement is to have its own priority.</p>
</li>
<li>
<p><strong>Intended Audience and Reading Suggestions</strong> -
Describe the different types of reader that the document is intended for, such as developers,
project managers, marketing staff, users, testers, and documentation writers. Describe what the
rest of this SRS contains and how it is organized. Suggest a sequence for reading the document,
beginning with the overview sections and proceeding through the sections that are most pertinent
to each reader type.</p>
</li>
<li>
<p><strong>Product Scope</strong> -
Provide a short description of the software being specified and its purpose, including relevant
benefits, objectives, and goals. Relate the software to corporate goals or business strategies. If a
separate vision and scope document is available, refer to it rather than duplicating its contents
here.</p>
</li>
<li>
<p><strong>References</strong> -
List any other documents or Web addresses to which this SRS refers. These may include user
interface style guides, contracts, standards, system requirements specifications, use case
documents, or a vision and scope document. Provide enough information so that the reader could
access a copy of each reference, including title, author, version number, date, and source or
location.</p>
</li>
</ul>
<h4 id="overall-description"><a class="header" href="#overall-description">Overall Description</a></h4>
<ul>
<li>
<p><strong>Product Perspective</strong> -
Describe the context and origin of the product being specified in this SRS. For example, state
whether this product is a follow-on member of a product family, a replacement for certain existing
systems, or a new, self-contained product. If the SRS defines a component of a larger system,
relate the requirements of the larger system to the functionality of this software and identify
interfaces between the two. A simple diagram that shows the major components of the overall
system, subsystem interconnections, and external interfaces can be helpful.</p>
</li>
<li>
<p><strong>Product Functions</strong> -
Summarize the major functions the product must perform or must let the user perform. Details
will be provided in Section 3, so only a high level summary (such as a bullet list) is needed here.
Organize the functions to make them understandable to any reader of the SRS. A picture of the
major groups of related requirements and how they relate, such as a top level data flow diagram
or object class diagram, is often effective.</p>
</li>
<li>
<p><strong>User Classes and Characteristics</strong> -
Identify the various user classes that you anticipate will use this product. User classes may be
differentiated based on frequency of use, subset of product functions used, technical expertise,
security or privilege levels, educational level, or experience. Describe the pertinent characteristics
of each user class. Certain requirements may pertain only to certain user classes. Distinguish the
most important user classes for this product from those who are less important to satisfy.</p>
</li>
<li>
<p><strong>Operating Environment</strong> -
Describe the environment in which the software will operate, including the hardware platform,
operating system and versions, and any other software components or applications with which it
must peacefully coexist.</p>
</li>
<li>
<p><strong>Design and Implementation Constraints</strong> -
Describe any items or issues that will limit the options available to the developers. These might
include: corporate or regulatory policies; hardware limitations (timing requirements, memory
requirements); interfaces to other applications; specific technologies, tools, and databases to be
used; parallel operations; language requirements; communications protocols; security
considerations; design conventions or programming standards (for example, if the customer’s
organization will be responsible for maintaining the delivered software).</p>
</li>
<li>
<p><strong>User Documentation</strong> -
List the user documentation components (such as user manuals, on-line help, and tutorials) that
will be delivered along with the software. Identify any known user documentation delivery formats
or standards.</p>
</li>
<li>
<p><strong>Assumptions and Dependencies</strong> -
List any assumed factors (as opposed to known facts) that could affect the requirements stated
in the SRS. These could include third-party or commercial components that you plan to use,
issues around the development or operating environment, or constraints. The project could be
affected if these assumptions are incorrect, are not shared, or change. Also identify any
dependencies the project has on external factors, such as software components that you intend
to reuse from another project, unless they are already documented elsewhere (for example, in the
vision and scope document or the project plan).</p>
</li>
</ul>
<h4 id="external-interface-requirements"><a class="header" href="#external-interface-requirements">External Interface Requirements</a></h4>
<ul>
<li>
<p><strong>User Interfaces</strong> -
Describe the logical characteristics of each interface between the software product and the
users. This may include sample screen images, any GUI standards or product family style guides
that are to be followed, screen layout constraints, standard buttons and functions (e.g., help) that
will appear on every screen, keyboard shortcuts, error message display standards, and so on.
Define the software components for which a user interface is needed. Details of the user interface
design should be documented in a separate user interface specification.</p>
</li>
<li>
<p><strong>Hardware Interfaces</strong> -
Describe the logical and physical characteristics of each interface between the software product
and the hardware components of the system. This may include the supported device types, the
nature of the data and control interactions between the software and the hardware, and
communication protocols to be used.</p>
</li>
<li>
<p><strong>Software Interfaces</strong> -
Describe the connections between this product and other specific software components (name
and version), including databases, operating systems, tools, libraries, and integrated commercial
components. Identify the data items or messages coming into the system and going out and
describe the purpose of each. Describe the services needed and the nature of communications.
Refer to documents that describe detailed application programming interface protocols. Identify
data that will be shared across software components. If the data sharing mechanism must be
implemented in a specific way (for example, use of a global data area in a multitasking operating
system), specify this as an implementation constraint.</p>
</li>
<li>
<p><strong>Communications Interfaces</strong> -
Describe the requirements associated with any communications functions required by this
product, including e-mail, web browser, network server communications protocols, electronic
forms, and so on. Define any pertinent message formatting. Identify any communication
standards that will be used, such as FTP or HTTP. Specify any communication security or
encryption issues, data transfer rates, and synchronization mechanisms.</p>
</li>
</ul>
<h4 id="system-features"><a class="header" href="#system-features">System Features</a></h4>
<ul>
<li><strong>System Feature 1</strong> -
<ul>
<li><strong>Description &amp; Priority</strong> -
Provide a short description of the feature and indicate whether it is of High,
Medium, or Low priority. You could also include specific priority component ratings,
such as benefit, penalty, cost, and risk (each rated on a relative scale from a low of
1 to a high of 9).</li>
<li><strong>Stimulus &amp; Response Sequences</strong> -
List the sequences of user actions and system responses that stimulate the
behavior defined for this feature. These will correspond to the dialog elements
associated with use cases.</li>
<li><strong>Functional Requirements</strong> -
Itemize the detailed functional requirements associated with this feature. These
are the software capabilities that must be present in order for the user to carry out
the services provided by the feature, or to execute the use case. Include how the
product should respond to anticipated error conditions or invalid inputs.
Requirements should be concise, complete, unambiguous, verifiable, and
necessary. Use “TBD” as a placeholder to indicate when necessary information is
not yet available.
<ul>
<li><strong>FR 1</strong> - ...</li>
<li><strong>FR 2</strong> - ...</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="other-nonfunctional-requirements"><a class="header" href="#other-nonfunctional-requirements">Other Nonfunctional Requirements</a></h4>
<ul>
<li>
<p><strong>Performance Requirements</strong> -
If there are performance requirements for the product under various circumstances, state them
here and explain their rationale, to help the developers understand the intent and make suitable
design choices. Specify the timing relationships for real time systems. Make such requirements as
specific as possible. You may need to state performance requirements for individual functional
requirements or features.</p>
</li>
<li>
<p><strong>Safety Requirements</strong> -
Specify those requirements that are concerned with possible loss, damage, or harm that could
result from the use of the product. Define any safeguards or actions that must be taken, as well
as actions that must be prevented. Refer to any external policies or regulations that state safety
issues that affect the product’s design or use. Define any safety certifications that must be
satisfied.</p>
</li>
<li>
<p><strong>Security Requirements</strong> -
Specify any requirements regarding security or privacy issues surrounding use of the product or
protection of the data used or created by the product. Define any user identity authentication
requirements. Refer to any external policies or regulations containing security issues that affect
the product. Define any security or privacy certifications that must be satisfied.</p>
</li>
<li>
<p><strong>Software Quality Attributes</strong> -
Specify any additional quality characteristics for the product that will be important to either the
customers or the developers. Some to consider are: adaptability, availability, correctness,
flexibility, interoperability, maintainability, portability, reliability, reusability, robustness, testability,
and usability. Write these to be specific, quantitative, and verifiable when possible. At the least,
clarify the relative preferences for various attributes, such as ease of use over ease of learning.</p>
</li>
<li>
<p><strong>Business Rules</strong> -
List any operating principles about the product, such as which individuals or roles can perform
which functions under specific circumstances. These are not functional requirements in
themselves, but they may imply certain functional requirements to enforce the rules.</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="white-box-testing"><a class="header" href="#white-box-testing">White-Box Testing</a></h1>
<p>Performing tests on software with the source code available. Generally, one should follow the following methodology:</p>
<ol>
<li>Make a prioritized list of your "nightmares".</li>
<li>Which bugs can lead to the nightmares?</li>
<li>Apply testing techniques that are best suited for detecting these bugs.</li>
<li>Gather enough evidence to that there the likelihood of a nightmare scenario is negligible, at which point stop testing.</li>
</ol>
<p>Static Analysis is one of the most powerful tools, leveraging compilers and linting is a must.</p>
<h3 id="control-flow-testing"><a class="header" href="#control-flow-testing">Control-Flow Testing</a></h3>
<p>Testing coverage is a measure of completeness of the set of test cases and shows how much code has been exercised during testing.</p>
<ul>
<li>
<p><strong>Level 1 Statement Coverage</strong> - Weakest criteria, ensures that every statement in code has been executed at least once.</p>
</li>
<li>
<p><strong>Level 2 Decision Coverage</strong> - Ensures that the decision of all branches has been taken at least once. Includes statement coverage.</p>
</li>
<li>
<p><strong>Level 3 Condition Coverage</strong> - Ensures that every "simple" condition has been evaluated with both true and false. This doesn't mean that all "composite" conditions have been extensively evaluated.</p>
</li>
<li>
<p><strong>Level 4 Decision/Condition Coverage</strong> - All conditions and decisions is evaluated with both values. In this case decisions can be the composition of multiple conditions.</p>
</li>
<li>
<p><strong>Level 5 Multiple Condition Coverage</strong> - Requires that all combinations of "simple" conditions are covered.</p>
</li>
<li>
<p><strong>Level 6 Modified Condition/Decision Coverage</strong> - Requires that all decisions have been covered, that all simple conditions have been evaluated with both true and false, and that each simple condition within all compound conditions has been shown to independently effect outcome of the compound condition.</p>
</li>
<li>
<p><strong>Level 7 Full Path Coverage</strong> - Fully exhaustive white box testing, but tends to be infeasible.</p>
</li>
</ul>
<h3 id="data-flow-testing"><a class="header" href="#data-flow-testing">Data-Flow Testing</a></h3>
<p>The aim is to trim the set of test cases that we are interested in. Increases the chance of spending more time looking at paths that include potential software faults.</p>
<ul>
<li>All <em>Def-Use</em> Paths: test cases must exercise all paths that involve a definition and use of variables of interest.</li>
</ul>
<h3 id="test-adequacy"><a class="header" href="#test-adequacy">Test Adequacy</a></h3>
<p>When has a program been sufficiently tested? A test adequacy criterion such as Mutant Score, reveals how well our test cases are performing.</p>
<blockquote>
<p><strong>Definition:</strong>
A code mutant is a version of the software under test that underwent some form of mutation, for example, arithmetic operators have been replaced.</p>
</blockquote>
<p>Mutants can survive if their output is correct for any given test case. Survivors are analyzed to improve test cases. However, some (equivalent) mutants might never be killed. Mutant Score is defined as <code>#killed_mutants / #total_mutants</code>.</p>
<h3 id="unit-testing"><a class="header" href="#unit-testing">Unit Testing</a></h3>
<p>Testing an individual module / component of a system. In practice, this is testing of a single method or class. <a href="https://en.wikipedia.org/wiki/Unit_testing">(wiki)</a></p>
<h3 id="integration-testing"><a class="header" href="#integration-testing">Integration Testing</a></h3>
<p>Testing the multiple parts of the system as a group. Typically it follows after modules have been unit tested. <a href="https://en.wikipedia.org/wiki/Integration_testing">(wiki)</a></p>
<ul>
<li><em>big-bang</em> - modules are coupled together to form a complete system that is tested</li>
<li><em>top-down</em> - start with highest level module and then test step by step down incrementally</li>
<li><em>bottom-up</em> - start with the lowest level module, test your way up by integrating</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="black-box-testing"><a class="header" href="#black-box-testing">Black Box Testing</a></h1>
<p>Testing when the source code is not available.</p>
<h1 id="techniques"><a class="header" href="#techniques">Techniques</a></h1>
<h3 id="bva---boundary-value-analysis"><a class="header" href="#bva---boundary-value-analysis">BVA - Boundary Value Analysis</a></h3>
<p>For mechanisms that have input ranges, apply test cases that position themselves at the boundaries of those ranges. For each of the following test just above and just below:</p>
<ul>
<li>min</li>
<li>nominal</li>
<li>max</li>
</ul>
<h3 id="ep---equivalence-partitioning"><a class="header" href="#ep---equivalence-partitioning">EP - Equivalence Partitioning</a></h3>
<p>If the program creates classes from the input, make sure all classes are represented. Can be done by finding representative values in the input domain or the output domain. If there are multiple input variables there are the following:</p>
<ul>
<li>Unidimensional partition - only focus on one variable at a time and ignore the others.</li>
<li>Multidimensional partition - test all variables in all possible combinations</li>
</ul>
<h3 id="mbt---model-based-testing"><a class="header" href="#mbt---model-based-testing">MBT - Model Based Testing</a></h3>
<p>A model is made from requirements and generates test cases. Use different notations such as pre/post conditions.</p>
<ul>
<li>
<p>Input domain models: Combinatorial Design</p>
<ul>
<li>assist the design of the test cases and offer a significant reduction in the number of test cases</li>
</ul>
</li>
<li>
<p>Input domain models: Syntax Testing</p>
<ul>
<li>used to verify that a module that accepts input from another module does not fail when presented ill-formed input</li>
<li>The syntax is the model of the input, Inputs are specified in SRS using a grammar or a context-free language</li>
<li>used to test compilers!</li>
</ul>
</li>
<li>
<p>Behavior Models:</p>
<ul>
<li>Test the use cases, capture system's functional requirements from user's perspective</li>
<li>Decision Tables - used to concisely and completely show complex rules and their resulting actions: test cases can be
<ul>
<li>at least one test case for each rule</li>
<li>if the rule is a range of values combine DT and BVA</li>
</ul>
</li>
<li>Cause-effect graphs / dependency modeling - design test cases for functions that depend on a combination of more input items</li>
<li>State Machines - test cases should:
<ul>
<li>visit all states</li>
<li>trigger all events at least once</li>
<li>exercise all transitions</li>
<li>execute all paths at least once</li>
</ul>
</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="advanced-operating-systems"><a class="header" href="#advanced-operating-systems">Advanced Operating Systems</a></h1>
<p>An operating system is comprised of many layers of abstraction where each layer generally takes on a different responsibility. At the lowest level is the <strong>kernel</strong> which interacts directly with the hardware and runs with the highest level of privilege. Then the kernel is wrapped in a <em>"shell"</em> of <strong>system software</strong>. These are user space programs that interact with the kernel and provide critical functionality. Lastly, there is an optional <strong>desktop environment</strong> that provides a graphical user interface, if the OS is being used directly by end users.</p>
<pre><code>     +--------------------------+
     |   Desktop Environment    |
     |  +--------------------+  |
     |  |  System Software   |  |
     |  |  +--------------+  |  |
     |  |  |    Kernel    |  |  |
     |  |  | +----------+ |  |  |
     |  |  | | Hardware | |  |  |
     +--------------------------+
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="genesis-x86-64"><a class="header" href="#genesis-x86-64">Genesis (x86-64)</a></h1>
<p>After pressing the power on button:</p>
<ol>
<li>CPU executes code in ROM.</li>
<li>Loads firmware BIOS, UEFI, Coreboot, OpenFirmware into memory</li>
<li>Initializes memory and other devices</li>
<li>Loads boot code into memory, traditionally first sector was boot code</li>
</ol>
<p>Traditional <strong>two-stage bootloader</strong> is there for historical reasons, since there were only 512bytes available for the first boot section. Thus, it must simply load the second stage boot code with more memory available.</p>
<h1 id="questions"><a class="header" href="#questions">Questions</a></h1>
<ul>
<li>When booting why is it required to go through all modes?</li>
<li>How is ROM code updated on older hardware?</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="physical-memory"><a class="header" href="#physical-memory">Physical Memory</a></h1>
<p>The memory controller communicates on the BUS over different channels (usually 1 / 2), but only one <strong>channel</strong> can be active at a time. For each channel there are physical memory modules (<a href="https://en.wikipedia.org/wiki/DIMM">DIMMs</a>). One side of the <strong>DIMM</strong> is a <strong>rank</strong>, typically 1/2 ranks per DIMM. Each rank has a <strong>chip</strong>, with a number of <strong>rows and columns</strong>.</p>
<p>Linux organizes memory into consecutive page frames and grouped together in the following way:</p>
<ul>
<li>Nodes - <a href="https://en.wikipedia.org/wiki/Non-uniform_memory_access">NUMA</a> abstraction for N "banks"</li>
<li>Zones - tagged regions within each node</li>
<li>Pages - Physical page frames from each zone</li>
</ul>
<p>Linux Zone ranges:</p>
<ul>
<li>ZONE_DMA: 0 - 16MB <em>for legacy hardware</em></li>
<li>ZONE_DMA32: 16MB - 4GB <em>for legacy hardware</em></li>
<li>ZONE_NORMAL: 16MB - 896MB <em>for kernel - always mapped</em></li>
<li>ZONE_HIGHMEM: 896MB - END <em>used for kmap, on demand memory mapping x86</em></li>
</ul>
<p>Zones are managed independently, however boundaries become blurry when under pressure. Kernel daemon kswapd will reclaim memory when certain thresholds are crossed. Virtual memory mapping on x86-32 starts ZONE_DMA and ZONE_NORMAL directly after the PAGE_OFFSET and ZONE_HIGHMEM is mapped on demand. The PAGE_OFFSET is where the user space processes start. However, for x86-64 there are 47 bits of memory address space available, so it can simply map all zones into one continuous region.</p>
<h2 id="pages"><a class="header" href="#pages">Pages</a></h2>
<ul>
<li>4KB of physical memory</li>
<li><code>linux/mmzone.h</code> has mem_map array which holds page objects</li>
</ul>
<h1 id="allocators"><a class="header" href="#allocators">Allocators</a></h1>
<p>Linux has one main page allocator (Buddy allocator) which allocates contiguous areas of physical memory. All allocators custom to the kernel from different subsystems interact with it. The Memblock allocator is an early boot-time allocator, discarded after initialization and contains two simple data structures: all present memory and allocated memory regions. Memblock has the following procedures:</p>
<p>Setup: add all available physical memory regions, add reserved to reserved list, sort by base address
Allocation: first fit memory, add to reserved list and merge neighbors if possible
De-allocation: scans reserved list, split up regions if necessary</p>
<h2 id="memblock-boot-allocator"><a class="header" href="#memblock-boot-allocator">Memblock Boot Allocator</a></h2>
<p>Can only allocate memory and maintains an index to the next free block. It's essentially just one long array of bytes.</p>
<h2 id="buddy-allocator"><a class="header" href="#buddy-allocator">Buddy Allocator</a></h2>
<p>Power of two allocator with free coalescing. During allocation, requested size will go into a block that satisfies the size, unused remainders are inevitable. During de-allocation, neighboring buddy block is checked and coalesced if it is free (recursively). MAX_ORDER in linux specifies a power of two coefficient for the maximum number of orders (levels). Works at a per-zone separation.</p>
<h1 id="vmalloc-vs-slab-allocator"><a class="header" href="#vmalloc-vs-slab-allocator">vmalloc vs slab allocator</a></h1>
<ul>
<li>vmalloc
<ul>
<li>plugs in small holes and prevents external fragmentation</li>
<li>is better for very large allocations, since buddy/slab will then cause more external fragmentation</li>
<li>is slower than slab</li>
<li>uses non-contiguous physical memory</li>
<li>has its own range</li>
</ul>
</li>
<li>slab allocator
<ul>
<li>is very fast, since it uses a cache</li>
<li>uses contiguous physical memory</li>
</ul>
</li>
</ul>
<h3 id="fragmentation"><a class="header" href="#fragmentation">Fragmentation</a></h3>
<ul>
<li><strong>External fragmentation</strong> When a request for a large amount of memory comes in, although there might be enough memory for it, it is unable to be allocated due to many disjoint holes of unallocated space.
<ul>
<li>Solved by the <code>vmalloc</code> allocator which sits on top of buddy allocator for large allocations, uses first-fit technique and maps page frames in virtually continuous buffer to scattered pages across physical memory. Allocates a single page from the buddy allocator at a time.</li>
</ul>
</li>
<li><strong>Internal fragmentation</strong> Allocations smaller than 4Kb will always have wasted space, as well as when requests are just above the closest power of two.
<ul>
<li>Addressed with the <code>slab</code> allocator which also sits on top of buddy allocator. For small allocations, continuous in virtual memory as well as physical memory</li>
</ul>
</li>
</ul>
<h3 id="sanity-checks-during-development"><a class="header" href="#sanity-checks-during-development">Sanity Checks during development</a></h3>
<ul>
<li><code>CONFIG_DEBUG_PAGEALLOC</code>
<ol>
<li>Out of bounds detection, adds page guards before and after page which limits how far out of bounds accesses can go. Page canaries will be changed if magic value is changed are also possible.</li>
<li>Use after free detection (<code>kernel_map_pages</code>) simply unmaps virtual memory interrupt handled by MMU, accept for when it is reused again. Can also use page poisoning which lets us lazily detect write-after-frees, however also after page is reused, no longer protected</li>
<li><code>kmemcheck</code> - traps at every read to check if data is initialized, very expensive</li>
<li><code>kmemleak</code> - periodic garbage collection, reports about unlinked objects, false positives can happen</li>
<li><code>kasan</code> - compiler instrumentation, adds combines canary and poison ideas</li>
</ol>
</li>
<li>out of bounds detection only works for off-by-one errors, page-guard vs poison strategy performance difference is non-trivial, but generally page-guards are faster</li>
</ul>
<h1 id="questions-1"><a class="header" href="#questions-1">Questions</a></h1>
<ul>
<li>
<p>Holes in physical memory are either device mapped or reserved, what reserves them?</p>
<ul>
<li>BIOS reserves memory as well</li>
</ul>
</li>
<li>
<p>might the BIOS reserve memory regions? some holes backed by memory. Some should escape memory management logic</p>
</li>
<li>
<p>Why does the kernel have to use virtual memory addresses in the first place can't it just map directly?</p>
<ul>
<li>needs to provide memory separation for clients</li>
</ul>
</li>
<li>
<p>Padding added to zone struct caching?</p>
<ul>
<li>Cache sharing issues for multicore processors. Ping Pong effect can happen.</li>
</ul>
</li>
<li>
<p>Why do we need zones? - tag memory to differentiate for different purposes surface access only software cares about it, but devices might have hardware limitations.</p>
</li>
<li>
<p>Why do we need  pages? - since hardware provided page granularity</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="page-tables"><a class="header" href="#page-tables">Page Tables</a></h1>
<p>OS provides virtual memory addresses to processes. Page tables store the translation from virtual addresses to physical addresses and OS gets to decide on this mapping. Virtual addresses are the index to a page table entry in the page table where physical addresses of underlying data are stored. A special register <code>cr3</code> contains physical pointer to first page table. Each page defines an address space which is useful for separating memory for separate processes.</p>
<h3 id="address-spaces"><a class="header" href="#address-spaces">Address spaces</a></h3>
<ul>
<li>Virtualize physical memory can be reused every time</li>
<li>Flexible memory management for continuous memory for example</li>
<li>Provides isolation and separation for separate processes.
<ul>
<li>Shared memory can include same virtual memory for multiple process</li>
<li>threads use shared memory</li>
<li>1 process per 1 page table is typical</li>
<li>Many processes per 1 page table is shared memory</li>
<li>Dynamically linked libraries are loaded into phys mem once</li>
</ul>
</li>
</ul>
<h3 id="linear-page-table"><a class="header" href="#linear-page-table">Linear page table</a></h3>
<ul>
<li>Simple and old design</li>
<li>first 4 bits of Virtual address are index to array of physical offsets</li>
<li>remaining 12 bits are offset within page</li>
<li>1 bit for whether the memory is present or not</li>
</ul>
<h3 id="hierarchical-page-table"><a class="header" href="#hierarchical-page-table">Hierarchical page table</a></h3>
<ul>
<li>first 10 bits are index to level 1 page table containing address of 2nd physical page table</li>
<li>second 10 bits are index to level 2 page table</li>
<li>remaining 12 bits are offset within page</li>
</ul>
<h3 id="inverted-page-tables"><a class="header" href="#inverted-page-tables">Inverted Page tables</a></h3>
<ul>
<li>IA64 (itanic)</li>
<li>using a hash of the virtual memory to store physical address, scales well</li>
</ul>
<h3 id="four-level-page-table"><a class="header" href="#four-level-page-table">Four-level Page Table</a></h3>
<ul>
<li>cr3 contains pointer to PML4 table which is highest level table</li>
<li>Highest bytes on intel aren't used by default Memory Tagging possible, set by sign extended</li>
<li>Virtual address contains:
<ul>
<li>First 16 bits are sign extend or MT Tagging</li>
<li>First 9 bits: PML4 offset</li>
<li>Second 9 bits: Page Directory-Pointer Offset</li>
<li>Third 9 bits: Page Directory Offset</li>
<li>Fourth 9 bits: Page Table Offset</li>
<li>Last 12 bits: Physical Page Offset</li>
</ul>
</li>
</ul>
<h2 id="page-table-entries"><a class="header" href="#page-table-entries">Page Table Entries</a></h2>
<ul>
<li>64 bits, contain bits for if present, writable, supervisor mode, etc...</li>
<li>48bit virtual address and physical address space</li>
<li>Address of large pages:
<ul>
<li>first level PTE doesn't support (512GB) pages</li>
<li>second level PTE supports 1GB Pages</li>
<li>third level PTE supports 2MB Pages</li>
<li>4th PTE only 4K Pages</li>
</ul>
</li>
</ul>
<h2 id="on-boot"><a class="header" href="#on-boot">On Boot</a></h2>
<ul>
<li>asm code loads addresses of the 4 levels depending on how much static memory kernel requires</li>
<li>only static</li>
</ul>
<h2 id="post-boot"><a class="header" href="#post-boot">Post Boot</a></h2>
<ul>
<li>Dynamic, allows page table mappings to change during runtime</li>
<li>Map more pages if more memory is needed</li>
<li>Unmap pages if memory is not needed</li>
<li>What should virtual address space look like in terms of policies?</li>
<li>How are they enforced?</li>
</ul>
<h2 id="virtual-address-space-of-process-p"><a class="header" href="#virtual-address-space-of-process-p">Virtual address space of process P</a></h2>
<ul>
<li>How can we ensure address space of P and P+1 are separate -&gt; page tables</li>
</ul>
<h2 id="meltdown"><a class="header" href="#meltdown">Meltdown</a></h2>
<ul>
<li>Kernel is mapped into higher regions of address space for P, how to make sure P can't access/modify Kernel data?
<ul>
<li>User supervisor bit can be set in PTE, process can't access kernel data despite it being mapped in</li>
<li>Post 2018 Meltdown was able to read kernel data, kernel no longer mapped in address space
<ul>
<li>Kernel now has own page table</li>
<li>on every syscall or Process switch, page tables must be changed, performance impact</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="foreshadow-attack"><a class="header" href="#foreshadow-attack">Foreshadow Attack</a></h2>
<ul>
<li>bypasses the present bit of a PTE, could read pages even if not present</li>
<li>Now we must clear page frame address when un-mapping</li>
</ul>
<h2 id="ridl"><a class="header" href="#ridl">RIDL</a></h2>
<ul>
<li>bypass the address bits - able to read other data</li>
<li>must flush CPU registers to solve</li>
</ul>
<h1 id="page-table-walk"><a class="header" href="#page-table-walk">Page Table Walk</a></h1>
<ul>
<li>Dynamically update page tables for each address space</li>
<li>If a process maps/un-maps in memory, it must be added/removed to address space</li>
<li>MMU uses updated page tables</li>
<li>find page table entry (assume x86_64, 48bit virt addr, page table mapped into virtual memory)</li>
</ul>
<ol>
<li>locate top-level PT (read cr3 register or process struct)</li>
<li>Locate 2nd level PT
<ul>
<li>get virtual pointer to top-level page</li>
<li>use bits 39-47 of virtual address as index</li>
<li>Is the page table entry present? if no, then abort</li>
</ul>
</li>
<li>Locate 3rd level PT
<ul>
<li>get virtual pointer to 2nd level page</li>
<li>use bits 30-38 of virtual address as index</li>
<li>is page table entry present? if no, then abort</li>
</ul>
</li>
<li>...</li>
<li>Last page table entry has physical address of page</li>
</ol>
<h2 id="page-table-mapping"><a class="header" href="#page-table-mapping">Page Table Mapping</a></h2>
<ul>
<li>Input is Virtual address where mapping will take place, do the page table walk to find locate the page table entry</li>
<li>If entry not present at any level, allocate new page, store its physical address in non-present entry, continue with next level</li>
<li>Finally store physical address of page to be mapped in final PTE</li>
</ul>
<h2 id="page-table-unmapping"><a class="header" href="#page-table-unmapping">Page Table Unmapping</a></h2>
<ul>
<li>Locate PTE from virt addr to be unmapped with page table walk</li>
<li>zero out final table entry (Because of Foreshadow attack)</li>
<li>Free the page table (optional)</li>
<li>free the page</li>
</ul>
<h2 id="permission-bits"><a class="header" href="#permission-bits">Permission bits</a></h2>
<ul>
<li>P: page faults (0) or present (1)</li>
<li>R/W: read-only (0) or writable (1)</li>
<li>U/S: Supervisor-only (0) or user-accessible (1)
<ul>
<li>SMAP protection: 1 becomes user-only (follow POLP)</li>
</ul>
</li>
<li>XD: execute allowed (0) or disabled (1)</li>
</ul>
<h2 id="translation-lookaside-buffer-tlb"><a class="header" href="#translation-lookaside-buffer-tlb">Translation Lookaside Buffer (TLB)</a></h2>
<ul>
<li>result of PT translation is a mapping, so we cache the mapping</li>
<li>Hardware based cache that stores memory addresses</li>
<li>Temporal and spatial locality</li>
<li>TLB has very small size, due to implementing LRU</li>
<li>thus, bad temporal and spatial locality will reduce performance</li>
<li>Since TLB is a cache of the page tables, it must be flushed when the Page tables are changed (switching to a new address space) and when explicitly flushing</li>
<li>If TLB not flushed when necessary means disaster</li>
<li>Translation Caches
<ul>
<li>caching PT pages</li>
<li>OS can use bigger pages -&gt; shorter walk on TLB Miss</li>
<li>translation cache tagged with part of virt addr
<ul>
<li>reduce time it takes for a TLB miss</li>
<li>managed transparently by hardware</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="security"><a class="header" href="#security">Security</a></h2>
<ul>
<li>Use page tables to improve sanity checks leave holes and let CPU raise segmentation fault</li>
<li>holes in the identity map, just before and after array add guard page</li>
<li>Pros: no wastage</li>
<li>Cons: more complex management</li>
</ul>
<h3 id="exploits"><a class="header" href="#exploits">Exploits</a></h3>
<ul>
<li>kernels are Highly complex concurrent code (~20M lines of  code)</li>
<li>Physmap in linux is a primary target</li>
<li>kernel base address is a jump target</li>
</ul>
<h3 id="kernel-address-space-layout-randomization-kaslr"><a class="header" href="#kernel-address-space-layout-randomization-kaslr">Kernel Address Space Layout Randomization (KASLR)</a></h3>
<ul>
<li>Randomizes sections in kernel address space</li>
<li>The entire kernel code starts from a random address space
<ul>
<li>brute-forcing leads to crashes</li>
<li>leak kernel pointers, requires second vulnerability</li>
<li>side-channel attacks, very complex to defend</li>
</ul>
</li>
<li>entropy simplified, remains the same until reboot</li>
<li>random slot is chosen early during boot, kernel is mapped there</li>
<li>requires remapping kernel itself as well as its physical memory</li>
<li>use side channels to leak a kernel address</li>
</ul>
<h1 id="questions-2"><a class="header" href="#questions-2">Questions</a></h1>
<ul>
<li>What is in the address field of a PTE?
<ul>
<li>there is a fraction of a physical address along with the page table offset</li>
</ul>
</li>
<li>How much memory can be mapped in x86_64?
<ul>
<li>48 bits to store physical address = 2^40 * 2^8 = 256 Tb</li>
</ul>
</li>
<li>How much memory does a Page in the Page table map?
<ul>
<li>depends whether it is used for large pages, huge or normal pages, but each PTP is 4KB and each PTE is 8 bytes 4096/8 = 512 or 2^12 / 2^3 = 2^9</li>
</ul>
</li>
<li>How to find page table pages?
<ul>
<li>Go through levels of page tables to find entry we want to change.</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="user-mode"><a class="header" href="#user-mode">User Mode</a></h1>
<p>Any OS will make sure that sys resources can be multiplexed by competing applications. Should happen safely and efficiently. CPU provides support for privileged instructions</p>
<h3 id="privilege-separation"><a class="header" href="#privilege-separation">Privilege Separation</a></h3>
<ul>
<li>x86 has 4 rings of privilege
<ul>
<li>ring 0: runs kernel, most privileges</li>
<li>ring 1,2: unused</li>
<li>ring 3: user code</li>
</ul>
</li>
<li>Pointers can be associated either with:
<ul>
<li>Code segments (CS)</li>
<li>Data segments (DS) - heap pointer</li>
<li>Stack Segment (SS) - Local variable pointer</li>
</ul>
</li>
<li>CS:0x1000 can be different than DS:0x1000</li>
<li>However, today all segments point to same memory</li>
<li>low-order 2 bits of CS register determine current ring</li>
<li>No instruction sets CS register directly
<ul>
<li>From user -&gt; Kernel
<ul>
<li>interrupt CPU ("int" instruction)</li>
<li>CPU switches to interrupt handler in kernel (from interrupt table containing functions)</li>
</ul>
</li>
<li>From kernel -&gt; user mode
<ul>
<li>Kernel interrupt handler returns ("iret" instruction)</li>
<li>CPU restores user mode state, including CS</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="global-descriptor-table"><a class="header" href="#global-descriptor-table">Global Descriptor Table</a></h4>
<ul>
<li>specifies all the segments and different rings</li>
<li>GDTR register points to the GDT</li>
<li>DPL Field decides which ring can access memory</li>
</ul>
<h1 id="task-struct-linux"><a class="header" href="#task-struct-linux">Task struct (linux')</a></h1>
<ul>
<li>contains pid, parent_pid, frame of registers and pointer to page_table</li>
<li>contains a specific state, stack pointer, which cpu, memory management, credentials, open files that process can access</li>
</ul>
<h1 id="security-1"><a class="header" href="#security-1">Security</a></h1>
<ul>
<li>
<p>Meltdown</p>
<ul>
<li>speculative code reads data into cache</li>
<li>KPTI Kernel Page Table Isolation, performance hit</li>
</ul>
</li>
<li>
<p>Foreshadow</p>
<ul>
<li>PTE address bits must also be cleared</li>
</ul>
</li>
<li>
<p>RIDL</p>
<ul>
<li>bypasses the address bits</li>
<li>ver instruction flushes address</li>
</ul>
</li>
<li>
<p>Defending Kernel Attacks: prevent kernel vulnerabilities from directing control flow to user land code by enabling SMAP Supervisor Mode Access Protection</p>
</li>
<li>
<p>ASLR: user process randomization</p>
<ul>
<li>linux mmap provides 28 bits of entropy</li>
</ul>
</li>
</ul>
<h1 id="questions-3"><a class="header" href="#questions-3">Questions</a></h1>
<ul>
<li>Where is GDT stored and who is responsible for it?</li>
<li>What is the minimum of kernel code needed to map into a process? interrupt handler and sys calls</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interrupts"><a class="header" href="#interrupts">Interrupts</a></h1>
<p>An event that interrupts the execution flow of the kernel. It gets handled by the kernel before the program execution can continue. From the perspective of the CPU they can either be <em>external</em> - (key presses, network packets) or <em>internal</em> - (divide by zero, page fault).</p>
<h3 id="terminology-intel-based"><a class="header" href="#terminology-intel-based">Terminology (Intel based)</a></h3>
<ul>
<li>
<p>Interrupt (something needs handling)</p>
<ul>
<li>External:
<ul>
<li>Hardware generated, a device triggers the interrupt through a pin on the CPU, masking allows to postpone consecutive interrupts (only kernel can set masks)</li>
<li>Software generated, software needs something form kernel - opening a file, allocating memory, any system call (<code>int n</code> defines the type of interrupt where n is 1 byte)</li>
</ul>
</li>
<li>Internal - <em>see question 1</em></li>
</ul>
</li>
<li>
<p>Exception (something went wrong)</p>
<ul>
<li>Fault - error condition (/0, page fault...) instruction can be retried</li>
<li>Trap - Typically for debugging (breakpoint, overflow) program can resume</li>
<li>Abort - serious error condition that is unrecoverable, process cannot continue (double fault or unrecoverable hardware error)</li>
</ul>
</li>
<li>
<p>Asynchronous vs Synchronous interrupts</p>
<ul>
<li>most software interrupts are synchronous - kernel can handle specific to the instruction</li>
<li>most hardware interrupts are asynchronous - can come at any time, masking must be done</li>
</ul>
</li>
</ul>
<h3 id="privilege"><a class="header" href="#privilege">Privilege</a></h3>
<ul>
<li>Interrupt handlers run at high privilege level, but are handled in ring 0</li>
</ul>
<h3 id="interrupt-procedure"><a class="header" href="#interrupt-procedure">Interrupt Procedure</a></h3>
<ol>
<li>CPU elevates privilege level and switches to kernel stack</li>
<li>some user context is saved so that program can resume again</li>
<li>The interrupt's service routine is called</li>
<li>CPU restores some of the user context and drops the privilege level</li>
</ol>
<h3 id="idt-interrupt-descriptor-table"><a class="header" href="#idt-interrupt-descriptor-table">IDT Interrupt Descriptor Table</a></h3>
<ul>
<li>Max 256 entries</li>
<li>first 32 entries reserved exceptions</li>
<li>16 external hardware interrupts can be remapped using APIC unit</li>
<li>IDTR (R for register) contains IDT Base Address + IDT Limit</li>
</ul>
<h3 id="trap-vs-interrupt"><a class="header" href="#trap-vs-interrupt">Trap vs Interrupt</a></h3>
<ul>
<li>Interrupt will mask further interrupts</li>
<li>Trap (exception) will not mask</li>
</ul>
<h3 id="restoring-the-kernel-stack"><a class="header" href="#restoring-the-kernel-stack">Restoring the Kernel stack</a></h3>
<ul>
<li>TSS Task State Segment</li>
<li>TR Task Register</li>
<li>TSS contains stack pointers for each ring</li>
</ul>
<h3 id="returning"><a class="header" href="#returning">Returning</a></h3>
<ul>
<li>special <code>iret</code> returns all the state for the user process and makes sure the CS is set back to the right privilege</li>
</ul>
<h3 id="livelocks"><a class="header" href="#livelocks">Livelocks</a></h3>
<ul>
<li>Too many interrupts will cause the CPU to deal with nothing else.</li>
<li>should try do as little in the handling routine as possible</li>
<li>reduce number of interrupts</li>
<li>offload to hardware</li>
<li>switch to polling vs handling</li>
<li>hardware DMA, forego interrupts</li>
</ul>
<h1 id="questions-4"><a class="header" href="#questions-4">Questions</a></h1>
<ul>
<li>Are software interrupts considered strictly internal interrupts?</li>
<li>Where in memory is IDT?</li>
<li>Who sets IDTR?</li>
<li>Where is interrupt code in memory?</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="system-calls"><a class="header" href="#system-calls">System Calls</a></h1>
<p>Interrupts raised by software, a demand by a process requesting the kernel to do something.
Originally, it was just <code>int 0x80</code>, nowadays there are more optimized <code>syscall</code> instructions. User and Kernel code abide by calling convention to put the syscall number into %rax, and arguments are specified into specific registers (<code>rdi, %rsi, %rdx, %r10, %r8, %r9</code>). Kernel places return value into <code>%rax</code>.</p>
<h3 id="performance-of-syscalls"><a class="header" href="#performance-of-syscalls">Performance of Syscalls</a></h3>
<ul>
<li>IDT entry cached in CPU register to avoid cache misses.</li>
</ul>
<h1 id="questions-5"><a class="header" href="#questions-5">Questions</a></h1>
<p>Why exactly is there a pipeline performance issue?</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
